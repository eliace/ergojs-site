<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Documentation Source: core/core-def.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Documentation</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Ergo.html">Ergo</a>
						</li>
						
						<li>
							<a href="Ergo.core.html">core</a>
						</li>
						
						<li>
							<a href="Ergo.data.html">data</a>
						</li>
						
						<li>
							<a href="Ergo.events.html">events</a>
						</li>
						
						<li>
							<a href="Ergo.html.html">html</a>
						</li>
						
						<li>
							<a href="Ergo.layouts.html">layouts</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.html">widgets</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Ergo.core.Array.html">Array</a>
						</li>
						
						<li>
							<a href="Ergo.core.Collection.html">Collection</a>
						</li>
						
						<li>
							<a href="Ergo.core.Context.html">Context</a>
						</li>
						
						<li>
							<a href="Ergo.core.DataSource.html">DataSource</a>
						</li>
						
						<li>
							<a href="Ergo.core.Layout.html">Layout</a>
						</li>
						
						<li>
							<a href="Ergo.core.Object.html">Object</a>
						</li>
						
						<li>
							<a href="Ergo.core.StateManager.html">StateManager</a>
						</li>
						
						<li>
							<a href="Ergo.core.Widget.html">Widget</a>
						</li>
						
						<li>
							<a href="Ergo.core.WidgetArray.html">WidgetArray</a>
						</li>
						
						<li>
							<a href="Ergo.data.Collection.html">Collection</a>
						</li>
						
						<li>
							<a href="Ergo.data.Object.html">Object</a>
						</li>
						
						<li>
							<a href="Ergo.events.Dispatcher.html">Dispatcher</a>
						</li>
						
						<li>
							<a href="Ergo.events.Event.html">Event</a>
						</li>
						
						<li>
							<a href="Ergo.html.Button.html">Button</a>
						</li>
						
						<li>
							<a href="Ergo.html.Iframe.html">Iframe</a>
						</li>
						
						<li>
							<a href="Ergo.html.Img.html">Img</a>
						</li>
						
						<li>
							<a href="Ergo.html.Input.html">Input</a>
						</li>
						
						<li>
							<a href="Ergo.html.Select.html">Select</a>
						</li>
						
						<li>
							<a href="Ergo.html.Textarea.html">Textarea</a>
						</li>
						
						<li>
							<a href="Ergo.html.Widget.html">Widget</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Box.html">Box</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Button.html">Button</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Check.html">Check</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Field.html">Field</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Icon.html">Icon</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Inline.html">Inline</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Link.html">Link</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.List.html">List</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.NestedList.html">NestedList</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Panel.html">Panel</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Table.html">Table</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.TableRow.html">TableRow</a>
						</li>
						
						<li>
							<a href="Ergo.widgets.Text.html">Text</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="mixins.list.html" class="dropdown-toggle" data-toggle="dropdown">Mixins<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="Ergo.Observable.html">Observable</a>
						</li>
						
						<li>
							<a href="Ergo.Statable.html">Statable</a>
						</li>
						
						<li>
							<a href="Ergo.WidgetOptions.html">WidgetOptions</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#apply_all">apply_all</a>
						</li>
						
						<li>
							<a href="global.html#clear">clear</a>
						</li>
						
						<li>
							<a href="global.html#each">each</a>
						</li>
						
						<li>
							<a href="global.html#filter">filter</a>
						</li>
						
						<li>
							<a href="global.html#find">find</a>
						</li>
						
						<li>
							<a href="global.html#find_all">find_all</a>
						</li>
						
						<li>
							<a href="global.html#get">get</a>
						</li>
						
						<li>
							<a href="global.html#has_key">has_key</a>
						</li>
						
						<li>
							<a href="global.html#includes">includes</a>
						</li>
						
						<li>
							<a href="global.html#is_empty">is_empty</a>
						</li>
						
						<li>
							<a href="global.html#key_of">key_of</a>
						</li>
						
						<li>
							<a href="global.html#keys">keys</a>
						</li>
						
						<li>
							<a href="global.html#map">map</a>
						</li>
						
						<li>
							<a href="global.html#remove">remove</a>
						</li>
						
						<li>
							<a href="global.html#remove_at">remove_at</a>
						</li>
						
						<li>
							<a href="global.html#remove_if">remove_if</a>
						</li>
						
						<li>
							<a href="global.html#set">set</a>
						</li>
						
						<li>
							<a href="global.html#size">size(1)</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: core/core-def.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript ">/**
 * @namespace
 * 
 */
var Ergo = (function(){

	var E = {};



	/**
	 * Копирование свойств одного объекта в другой (создание примеси)
	 * @param {Object} obj целевой объект, которому будут добавлены новые свойства
	 * @name Ergo.override
	 * @function
	 */
	E.override = function(obj) {
		for(var j = 1; j &lt; arguments.length; j++){
			var overrides = arguments[j] || {};
			for(var i in overrides){
				obj[i] = overrides[i];
			}
		}
		return obj;
	};
	
	
	
	/**
	 * Полное копирование свойств одного объекта в другой (перегрузка) 
	 * @param {Object} obj целевой объект, которому будут добавлены новые свойства
	 * @name @Ergo.deep_override
	 * @function
	 * 
	 */
	E.deep_override = function(o) {
		
		for(var j = 1; j &lt; arguments.length; j++){
		
			var srcObj = arguments[j];
			
//			E.each(srcObj, function(p, i){
			for(var i in srcObj) {
				
				var p = srcObj[i];
				
				if( p && p.constructor == Object ){//$.isPlainObject(p) ){
	//				if(!(i in o) || !$.isPlainObject(o[i])) o[i] = {};
					if(!(i in o) || (o[i] && o[i].constructor != Object)) o[i] = {};
					Ergo.deep_override(o[i], p);
				}
				else if( p && p.constructor == Array ) {//$.isArray(p) ){
	//				if(!(i in o) || !$.isArray(o[i])) o[i] = [];
					if(!(i in o) || (o[i] && o[i].constructor != Array)) o[i] = [];
					Ergo.deep_override(o[i], p);
				}
				else {
					o[i] = p;
				}
			}
		
		}
		
		return o;
	};
	
	
	
	
	
	
	
//	var _clear = false;
	
	
	
	var smart_override_prop = function(o, srcObj, i, context) {
	
		var p = srcObj[i];


		var prefix = i[0];
//		var j = i;
		
//		var keep_prefix = !_clear;


		if(prefix == '!' || prefix == '+' || prefix == '-') {
			i = i.substr(1);
		}
		else {
			
			prefix = false;
			
			if(i == 'data') prefix = '!'; 										//&lt;-- поле data не перегружается
			if(i == 'mixins') prefix = '+'; 				//&lt;-- поле mixins сливается
			if(i == 'cls') prefix = '+';
			if(i == 'state') prefix = '+';
			if( /^on\S/.test(i) ) prefix = '+';
			if(/\/events$/.test(context)) {
				prefix = '+';
			}
			
//			if(prefix)
//				keep_prefix = false;
			
			
			// Если в целевом объекте присутствует префиксная форма, то берется ее префикс
			if('!'+i in o) {
				prefix = '!';
//				i = '!'+i;
			}
			else if('+'+i in o) {
				prefix = '+';
//				i = '+'+i;
			}
			else if('-'+i in o) {
				prefix = '-';
//				i = '-'+i;
			}
			
		}
	
		
	
	

	
		if(prefix) {//prefix == '!' || prefix == '+' || prefix == '-') {
			
			var j = prefix + i;
			
//			var j = i.substr(1);
			
//			if(_clear) i = j;
			
			var m = null;

			
			if(prefix == '+') {
				
				m = [];
				
				if(i in o)
					m = o[i];
				if(j in o)
					m = o[j];
				
				if( !$.isArray(m) ) m = [m];
				
				m = m.concat(p);

				o[j] = m;
				
				// if(keep_prefix) {
					// o[j] = m;
					// if(i in o) delete o[i];
				// }
				// else {
					// o[i] = m;
					// if(j in o) delete o[j];
				// }
				
				// if(!(i in o)) o[i] = [];
				// if( !$.isArray(o[i]) ) o[i] = [o[i]];
				// p = o[i].concat(p);
				// o[i] = p;
				
			}
			else if(prefix == '-') {
				
				m = [];
				
				if(i in o)
					m = o[i];
				if(j in o)
					m = o[j];
				
				if( !$.isArray(m) ) m = [m];
				
				m = m.concat(p);

				o[j] = m;
				
				
				
				
				// TODO
				
				// m = [];
// 				
				// if(i in o)
					// m = o[i];
				// if(j in o)
					// m = o[j];
// 				
				// if( !$.isArray(m) ) m = [m];
// 				
				// if( !$.isArray(p) ) p = [p];
// 				
				// for(var k = 0; k &lt; p.length; k++)
					// Ergo.remove_from_array(m, p[k]);
// 				
// 				
				// if(keep_prefix) {
					// o[j] = m;
					// if(i in o) delete o[i];
				// }
				// else {
					// o[i] = m;
					// if(j in o) delete o[j];
				// }				
				
			}
			else {
				m = p;
				
				o[j] = m;
				
//				if(m === undefined) delete o[i];
//				o[i] = p;
			}
			
			
			// if(keep_prefix) {
				// o[j] = m;
				// if(i in o) delete o[i];
			// }
			// else {
				// o[i] = m;
				// if(j in o) delete o[j];
			// }
			
//			if(j in o && !_clear) delete o[j];
		}
		else{
			//TODO здесь создается полная копия (deep copy) объекта-контейнера
			if( p && p.constructor == Object ) {//$.isPlainObject(p) ){
	//			if(!(i in o) || !$.isPlainObject(o[i])) o[i] = {};
				if(!(i in o) || (o[i] && o[i].constructor != Object)) o[i] = {};
				smart_override_obj(o[i], p, context+'/'+i);
			}
			else if( p && p.constructor == Array ){//$.isArray(p) ){
	//			if(!(i in o) || !$.isArray(o[i])) o[i] = [];
				if(!(i in o) || (o[i] && o[i].constructor != Array)) o[i] = [];
				smart_override_obj(o[i], p, context+'/'+i);
			}
			else {
				//TODO этот участок кода нужно исправить
				
				// // если элемент в перегружаемом параметре существует, то он может быть обработан специфически
				// if(i in o){
					// // классы сливаются в одну строку, разделенную пробелом
// //					if(i == 'cls') p = o[i] + ' ' + p;
					// if( /^on\S/.test(i) ) {
						// if( !$.isArray(o[i]) ) o[i] = [o[i]];
						// p = o[i].concat(p);
					// }
					// // if(i == 'state') {
						// // p = o[i] + ' ' + p;
					// // }
				// }
				
				o[i] = p;
			}
		}
		
	};
	
	
	
	var smart_override_obj = function(dest, src, context) {
		
		if(!dest)
			dest = {};
		
		
		for(var i in src)
			smart_override_prop(dest, src, i, context);
		
	};
	
	
	
	
	/**
	 * "Умное" копирование свойств одного объекта в другой (условная перегрузка) 
	 * @param {Object} obj целевой объект, которому будут добавлены новые свойства
	 * @name @Ergo.smart_override
	 * @function
	 * 
	 */
	E.smart_override = function(o) {
		
		
		// если перегружаемый объект содержит метод smart_override, то используем именно его
		if(o && o.smart_override) {
			// args будет содержать только список перегрузок
			var args = Array.prototype.slice.call(arguments);
			args.shift();
			return o.smart_override.apply(o, args);			
		}
	
	
//		var keep_keys = false;
		
		if(!o) {
//			_keep_keys = keep_keys = true;
			o = {};
		}
	
		// обходим все аргументы, начиная со второго
		for(var j = 1; j &lt; arguments.length; j++){
			
			var srcObj = arguments[j];
			
			smart_override_obj(o, srcObj, '');

			// for(var i in srcObj)
				// smart_override_prop(o, srcObj, i);				
			
	//		if( $.isArray(srcObj) ){
	//			for(var i = 0; i &lt; srcObj.length; i++)
	//				Ergo.utils.overrideProp(o, srcObj, i);
	//		}
	//		else {
		
		
	//		}		
		}
		
		// if(keep_keys)
			// _keep_keys = false;
		
		return o;
	};
	
	
	
	
	E.smart_build = function(o, key) {
		
		// применяем модификатор +
		for(var i in o) {
			
			var prefix = i[0];
			
			if(prefix == '+') {
				
				var j = i.substr(1);
				
				var m = (j in o) ? o[j] : [];
				if( !$.isArray(m) ) m = [m];
				
				m = m.concat(o[i]);
				
				o[j] = m;
				
				delete o[i];
			}
			
			
			if(prefix == '-') {
				
				var j = i.substr(1);
				
				var m = (j in o) ? o[j] : [];
				if( !$.isArray(m) ) m = [m];
				
				for(var n = 0; n &lt; o[i].length; n++) {
					for(var k = 0; k &lt; m.length; k++) {
						if(m[k] == o[i][n]) m.splice(k, 1);
					}
				}
				
				delete o[i];
			}



			if(prefix == '!') {
				
				var j = i.substr(1);
				
				if( o[i] === undefined )
					delete o[j];
				else
					o[j] = o[i];
				
				delete o[i];
			}
			
		}	

/*		
		// применяем модификатор -
		for(var i in o) {
			
			var prefix = i[0];
			
			if(prefix == '-') {
				
				var j = i.substr(1);
				
				var m = (j in o) ? o[j] : [];
				if( !$.isArray(m) ) m = [m];
				
				for(var n = 0; n &lt; o[i].length; n++) {
					for(var k = 0; k &lt; m.length; k++) {
						if(m[k] == o[i][n]) m.splice(k, 1);
					}
				}
				
				delete o[i];
			}
		}
		
		// применяем модификатор !
		for(var i in o) {
			
			var prefix = i[0];
			
			if(prefix == '!') {
				
				var j = i.substr(1);
				
				if( o[i] === undefined )
					delete o[j];
				else
					o[j] = o[i];
				
				delete o[i];
			}
			
		}
			
*/		
		
		
		if( k == 'shortcuts' || k == 'components' || k == 'items')
			return;
//		if(i == 'items') 
//			return;
			
		for(var i in o) {
			if(i == 'defaultItem' || i == 'defaultComponent' || i == 'layout') 
				continue;
			if(o[i] && o[i].constructor == Object)
				E.smart_build(o[i], i);
		}
		
	};
	
	
	
/*	
	E.self_smart_override = function() {
		
		// console.log(this);
		// console.log(arguments);
		
		_clear = true;
		
		// обходим все аргументы, начиная со второго
		for(var j = 0; j &lt; arguments.length; j++){
			
			var srcObj = arguments[j];
		
			smart_override_obj(this, srcObj, '');
		
			// for(var i in srcObj)
				// smart_override_prop(this, srcObj, i);
								
		}
		
		_clear = false;
		
		return this;
	};
*/	
	
	
	
	
	
	
//	E.etypes = function() { return _etypes; }
	
//	E.defineClass = E.declare;
	
	
	
	
//	E.widget = E.object;
	
	
	
	
/*	
	E.isFunction = function(obj) { return obj instanceof Function; };
	E.isArray = function(obj) {return obj instanceof Array;}
	E.isNumber = function(obj) {return typeof obj == 'number';};
	E.isBoolean = function(obj) {return typeof obj == 'boolean';};
	E.isString = function(obj) {return typeof obj == 'string';};
	E.isObject = function(obj) { return obj.constructor == Object; };
*/


	// в версии jquery 1.4 появились методы, которые раньше реализовывались в Ergo
	
	/**
	 * Является ли объект функцией 
	 * 
	 * @name $.isFunction
	 * @function
	 * @param {Object} obj
	 */
//	E.isFunction = $.isFunction;
	/**
	 * Является ли объект массивом
	 * 
	 * @name $.isArray
	 * @function
	 * @param {Object} obj
	 */
//	E.isArray = $.isArray;
	/**
	 * Является ли объект простым объектом
	 * 
	 * @name $.isPlainObject
	 * @function
	 * @param {Object} obj
	 */
//	E.isPlainObject = $.isPlainObject;
	/**
	 * Является ли объект строкой
	 * 
	 * @name $.isString
	 * @function
	 * @param {Object} obj
	 */
	$.isString = function(obj) {
		return typeof obj == 'string';
	};
	/**
	 * Является ли объект логической переменной
	 * 
	 * @name Ergo.isBoolean
	 * @function
	 * @param {Object} obj
	 */
	$.isBoolean = function(obj) {
		return typeof obj == 'boolean';
	};
	/**
	 * Является ли объект числом
	 * 
	 * @name $.isNumber
	 * @function
	 * @param {Object} obj
	 */
	// $.isNumber = function(obj) {
		// return typeof obj == 'number';
	// };	
	
	
	
	
	
	
	

	
	
	//---------------------------------------------------
	//
	// Фильтры
	//
	//---------------------------------------------------
	
	
	//FIXME эта функция не так уж нужна
	E.filter_list = function(val, list) {
		for(var i = 0; i &lt; list.length; i++)
			if(!list[i].call(this, val)) return false;
		return true;
	};
	
	
	
	E.sort_numbers = function(a, b) {
		return a - b;
	};
	
	
	
	
	
	

	
	
	
	E.loadpath = {};
	
	
	/*
	 * Синхронная загрузка модулей через Ajax
	 * 
	 * В качестве аргументов передается список путей к классам
	 * 
	 */
	E.require = function() {
		
		for(var i = 0; i &lt; arguments.length; i++) {

			var class_name = arguments[i];
			
			//TODO здесь нужно проверить, загружен ли класс
			try{
				if( eval('typeof '+class_name) == 'function') continue;
			}
			catch(e) {
			}
			
			for(var j in E.loadpath) {
				if(class_name.search(j) != -1) {
					class_name = class_name.replace(j, E.loadpath[j]);
					break;
				}
			}
			
			var url = class_name.replace(/\./g, '/') + '.js';
			
			$.ajax({
			  url: url,
			  dataType: "script",
			  success: function(){
			  	//TODO здесь нужно вызывать функцию, оповещающую, что класс загружен
			  },
			  error: function(jqXHR, textStatus, errorThrown){
			  	console.log(errorThrown);
			  },
			  async: false
			});			
			
		}
		
		
	};
	
	
	
	
	//TODO перенести в примеси
	E.glass_pane = function() {
		
		return $('&lt;div class="e-glass-pane" autoheight="ignore"/>')
			.on('mousedown', function(e){
				e.preventDefault();
				return false;				
			});
		
	};
	
	
	
	
	return E;
})();

//var _dino = Ergo;


/**
 * @namespace
 */
Ergo.core = {};










/*
 * Расширяем базовый класс Array методом удаления элемента
 * 
 * @name Array.prototype.remove
 * @function
 * @param {Any} val элемент массива
 */

/*
Array.prototype.remove = function(val) {
	var index = -1;
	for(var i = 0; i &lt; this.length; i++) {
		if(this[i] == val) {
			index = i;
			break;
		}
	}
	if(index != -1) this.splice(index, 1);
	
	return (index != -1);		
}
*/




Ergo.globals = {
	
};









</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		on Fri Nov 14 2014 01:28:07 GMT+0400 (MSK) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
